# üìä –°—Ç–∞—Ç—É—Å Backend API (2025-09-29)

## ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **Health Check** - ‚úÖ –†–ê–ë–û–¢–ê–ï–¢
   - URL: `GET /api/reports/health/`
   - –°—Ç–∞—Ç—É—Å: 200 OK
   - –û—Ç–≤–µ—Ç: `{"status": "ok", "tz": "Asia/Tashkent", "server_time": "..."}`

## ‚ùå –ß—Ç–æ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

**JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:**

```bash
curl -X POST https://luxa.uz/api/login/ -d '{"username": "bot_user", "password": "bot_password"}'
# –û—Ç–≤–µ—Ç: {"detail": "Invalid credentials"}
```

**X-Bot-Token –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:**

```bash
curl -H "X-Bot-Token: bot_test_token" https://luxa.uz/api/reports/daily/
# –û—Ç–≤–µ—Ç: {"detail": "Invalid bot token"}
```

### 2. Reports Endpoints

- `GET /api/reports/daily/` - ‚ùå 401 Unauthorized
- `GET /api/reports/range/` - ‚ùå 401 Unauthorized

### 3. Bot Token Generation

- `POST /api/generate_bot_token/` - ‚ùå 404 Not Found

## üîß –ß—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å

### 1. –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –±–æ—Ç–∞

–ù—É–∂–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:

- Username: `bot_user` (–∏–ª–∏ –¥—Ä—É–≥–æ–π)
- Password: `bot_password` (–∏–ª–∏ –¥—Ä—É–≥–æ–π)

### 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é

**–í–∞—Ä–∏–∞–Ω—Ç A: JWT**

- –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ credentials
- –ò–ª–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ credentials

**–í–∞—Ä–∏–∞–Ω—Ç B: X-Bot-Token**

- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å endpoint –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ bot token
- –ò–ª–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≥–æ—Ç–æ–≤—ã–π bot token

### 3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Reports API

–ù—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å endpoints —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:

```json
// GET /api/reports/daily/
{
  "date": "2025-09-28",
  "total_added": 53,
  "total_approved": 41,
  "total_rejected": 12,
  "top_regions": [...],
  "top_districts": [...],
  "top_users": [...]
}
```

## üöÄ –¢–µ–∫—É—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **mock –¥–∞–Ω–Ω—ã–µ** –¥–ª—è —Ä–∞–±–æ—Ç—ã:

```python
# –í api.py –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback –Ω–∞ mock –¥–∞–Ω–Ω—ã–µ
return {
    "date": "today",
    "total_added": 15,
    "total_approved": 12,
    "total_rejected": 3,
    "top_regions": [...],
    "top_districts": [...],
    "top_users": [...]
}
```

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **Backend Dev –¥–æ–ª–∂–µ–Ω:**

   - –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –±–æ—Ç–∞
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Reports API
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é

2. **–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
   - –û–±–Ω–æ–≤–∏—Ç—å `.env` —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ credentials
   - –£–±—Ä–∞—Ç—å mock –¥–∞–Ω–Ω—ã–µ –∏–∑ `api.py`
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ API endpoints

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ —Å mock –¥–∞–Ω–Ω—ã–º–∏:

- ‚úÖ Health endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ Mock –¥–∞–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ö–æ–º–∞–Ω–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç

**–°—Ç–∞—Ç—É—Å:** –û–∂–∏–¥–∞–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –≤ backend –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Ä–µ–∞–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º.
